{
    "contents" : "\\name{BEFDR}\n\\alias{BEFDR}\n\\title{\nBackward elimination in multi-locus association analysis\n}\n\\description{\nPerformes multi-locus backward elimination using adaptive FDR\n}\n\\usage{\nBEFDR( minimal.lm, maximal.lm, FDR.q,mfactor=1)\n}\n\\arguments{\n  \\item{minimal.lm}{\nA minimum model returned from lm, stating fixed effects and SNPs that will always be kept\n}\n \\item{maximal.lm}{\nA maximal model returned from lm, stating fixed effects and all SNPs. Note that the number of SNPs can not exceed the number of responses to avoid overfitting. Under overfitting, a chromosome based pre-selction can be performed\n}\n\\item{FDR.q}{\nDesired FDR value, usually set to 0.05-0.20.\n}\n\\item{mfactor}{\nA factor created to account for the ture model size. When a model selection started on the whole SNP set, set this factor to 1. Under the situation of pre-selection, the number of variants(n2) after pre selection is smaller than the whole set(n1). set m= n1/n2\n}\n}\n\\details{\nThis function perform Backward analysis based on an adaptive FDR. This model selection criterion is flexable to the input model size. Detials can be viewed in Sheng et al.(2015)\n\n}\n\\value{\nObject of class lm\n}\n\\references{\n\nAbramovich, F., Benjamini, Y., & Donoho, D. L. (2006). Special Invited Lecture: Adapting to Unknown Sparsity by Controlling the False Discovery Rate on JSTOR. The Annals of Statistics,Vol34.No.2584-653\n\nGavrilov, Y., Benjamini, Y., & Sarkar, S. K. (2009). JSTOR: The Annals of Statistics, Vol. 37, No. 2 (Apr., 2009), pp. 619-629. The Annals of Statistics.\n\nSheng Z, Pettersson ME, Honaker CF, Siegel PB, Carlborg Ã–. 2015. Standing genetic variation as a major contributor to adaptation in the Virginia chicken lines selection experiment. Genome Biol 16: 219.\n\n}\n\\author{\nyanjun zan\n}\n\\note{\n%%  ~~further notes~~\n}\n\n\n\\seealso{\n}\n\\examples{\n data(Chicken) # load required data\n\n\n sigMrk_sub<- sigMrk[!(sigMrk \\%in\\% mrksT)] # this is the fixed effect we want to keep in the minimal model\n    # find the id without missing values\n    colnames(mrk_geno)<- mrks_info[,1]\n    nna<-complete.cases(mrk_geno[,mrks_info[,1] \\%in\\% c(mrksT,sigMrk_sub)])\n    geno_reg<-mrk_geno[nna,c(mrksT,sigMrk_sub)] ## pick out the genotype info for all the included marker\n\n    # construct full model including all markers within the reg\n    id.full<- which(colnames(geno_reg) \\%in\\% c(mrksT,sigMrk_sub))\n    geno_add <- paste(\"as.numeric(geno_reg[,\",id.full,\"])\",sep=\"\",collapse=\"+\")\n    test_phe<-phe[nna]\n    test_fx1<-fx1[nna]\n    fm <- as.formula(paste(\"test_phe ~ test_fx1 +\",geno_add,sep=\"\"))\n    reg.lm <- lm(fm, y=TRUE)\n\n    # min model\n    id.min<-c(1:ncol(geno_reg))[colnames(geno_reg) \\%in\\% sigMrk_sub]\n    geno_bc.add<-paste(\"as.numeric(geno_reg[,\",id.min,\"])\",sep=\"\",collapse=\"+\")\n    fm.min<- as.formula(paste(\"test_phe ~ test_fx1 +\",geno_bc.add,sep=\"\"))\n    min.lm <- lm(fm.min,y=TRUE)\n\n    #Perform Backward-Elimination in the original data at different adaptive FDR thresholds\n    fitFDR5 <- BEFDR( minimal.lm = min.lm, maximal.lm = reg.lm, FDR.q = 0.05,mfactor=1)\n\n    ### get out the name of kept snp\n    if(sum(grepl(\"geno_reg\",rownames(summary(fitFDR5)$coefficients)))>0){\n      terms5<-rownames(summary(fitFDR5)$coefficients)[grep(\"geno_reg\",rownames(summary(fitFDR5)$coefficients))]\n      idx5<-unlist(strsplit(terms5,\",|[]]\"))\n      name5<-colnames(geno_reg)[as.numeric(idx5[seq(2,length(idx5),3)])]\n      id.in5<- name5[!(name5 \\%in\\% sigMrk_sub)] # this is the maker pass the FDR\n    }\n\n% Add one or more standard keywords, see file 'KEYWORDS' in the\n% R documentation directory.\n\\keyword{ BEFDR}\n",
    "created" : 1484819733876.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "4292176355",
    "id" : "6A74AAAB",
    "lastKnownWriteTime" : 1484826683,
    "path" : "~/Documents/chicken/BE/man/BEFDR.Rd",
    "project_path" : "man/BEFDR.Rd",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "relative_order" : 5,
    "source_on_save" : false,
    "type" : "r_doc"
}